# LinkrDev 微服务架构设计

## 🏗️ 架构概览

LinkrDev 采用微服务架构，将原本的单体应用拆分为多个独立的服务，每个服务负责特定的业务功能。

## 📊 服务拆分方案

### 1. 认证服务 (Auth Service)
- **端口：** 8081
- **职责：**
  - JWT Token 生成和验证
  - 用户登录认证
  - 短信验证码发送
  - 权限验证
- **技术栈：** Spring Boot + Spring Security + JWT
- **独立原因：** 安全敏感，需要独立部署和监控

### 2. 用户服务 (User Service)
- **端口：** 8082
- **职责：**
  - 用户信息管理
  - 用户CRUD操作
  - 用户资料更新
  - 用户状态管理
- **技术栈：** Spring Boot + MySQL + MyBatis
- **独立原因：** 高频访问，需要独立扩展

### 3. 管理服务 (Admin Service)
- **端口：** 8083
- **职责：**
  - 管理后台功能
  - 系统配置管理
  - 管理员用户管理
  - 系统监控
- **技术栈：** Spring Boot + MySQL + Spring Security
- **独立原因：** 管理功能，访问频率较低

### 4. Dubbo服务 (Dubbo Service)
- **端口：** 20880
- **职责：**
  - 内部服务间通信
  - 业务逻辑处理
  - 高性能RPC调用
  - 服务治理
- **技术栈：** Spring Boot + Dubbo + Nacos
- **独立原因：** 高性能RPC，需要独立优化

### 5. API网关 (Gateway Service)
- **端口：** 8080
- **职责：**
  - 统一入口
  - 路由转发
  - 负载均衡
  - 限流熔断
  - 请求过滤
- **技术栈：** Spring Cloud Gateway + Nacos
- **独立原因：** 统一入口，需要高可用

### 6. 服务注册中心 (Nacos)
- **端口：** 8848
- **职责：**
  - 服务注册与发现
  - 配置管理
  - 服务健康检查
  - 动态配置更新
- **技术栈：** Nacos Server
- **独立原因：** 微服务基础设施

## 🔄 服务间通信

### HTTP REST API
- 外部客户端 → API网关 → 各微服务
- 服务间通过REST API进行通信

### Dubbo RPC
- 内部服务间通过Dubbo进行高性能RPC调用
- 支持服务治理、负载均衡、容错等特性

## 🗄️ 数据存储

### 数据库设计
- **主数据库：** MySQL (linkr_admin)
- **服务数据库分离：** 每个服务可以有自己的数据库
- **数据一致性：** 通过分布式事务保证

### 缓存策略
- **Redis：** 用户会话、热点数据缓存
- **本地缓存：** 服务内部缓存

## 🚀 部署方案

### 方案一：传统部署
```bash
# 使用批处理脚本部署
deploy-microservices.bat
```

### 方案二：Docker部署
```bash
# 使用Docker Compose部署
docker-compose up -d
```

### 方案三：Kubernetes部署
```bash
# 使用K8s部署（需要额外的k8s配置文件）
kubectl apply -f k8s/
```

## 📈 扩展性设计

### 水平扩展
- 每个服务可以独立扩展
- 支持多实例部署
- 通过负载均衡分发请求

### 垂直扩展
- 根据业务需求调整服务资源
- 支持不同服务使用不同配置

## 🔒 安全设计

### 认证授权
- 统一认证中心
- JWT Token机制
- 细粒度权限控制

### 网络安全
- 服务间通信加密
- API网关安全过滤
- 防火墙规则配置

## 📊 监控运维

### 日志管理
- 每个服务独立日志
- 统一日志收集
- 日志分析和告警

### 健康检查
- 服务健康检查
- 自动故障恢复
- 性能监控

### 链路追踪
- 分布式链路追踪
- 请求链路分析
- 性能瓶颈定位

## 🎯 优势分析

### 1. 高可用性
- 服务独立部署，单个服务故障不影响整体
- 支持服务降级和熔断
- 多实例部署提高可用性

### 2. 可扩展性
- 按需扩展特定服务
- 支持不同服务使用不同技术栈
- 便于新功能开发和部署

### 3. 可维护性
- 代码职责清晰
- 独立开发和测试
- 便于问题定位和修复

### 4. 技术多样性
- 不同服务可以使用最适合的技术
- 便于技术升级和迁移
- 降低技术债务

## ⚠️ 注意事项

### 1. 复杂性增加
- 服务间通信复杂
- 部署和运维复杂度增加
- 需要更多的监控和治理

### 2. 数据一致性
- 分布式事务处理
- 数据同步问题
- 最终一致性保证

### 3. 网络延迟
- 服务间调用增加延迟
- 需要优化网络配置
- 考虑缓存策略

## 🔧 下一步计划

1. **完善服务拆分：** 进一步细化服务边界
2. **添加监控：** 集成Prometheus + Grafana
3. **优化性能：** 添加缓存和连接池
4. **安全加固：** 完善安全机制
5. **自动化部署：** CI/CD流水线建设
